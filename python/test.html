<!doctype html>
<html lang="ru">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Итоговый тест: Программирование на Python - Junior</title>
    <style>
        /* unified styling aligned with module (index.html) */
        body {
            font-family: system-ui, Arial;
            margin: 20px;
            background: #f7fbff;
            color: #102a43
        }

        .wrap {
            max-width: 980px;
            margin: 0 auto
        }

        header {
            display: flex;
            align-items: center;
            gap: 12px
        }

        h1 {
            color: #0b3d91;
            margin: 6px 0
        }

        .small {
            font-size: 13px;
            color: #445
        }

        .card {
            background: #fff;
            border-radius: 10px;
            padding: 16px;
            margin: 14px 0;
            box-shadow: 0 2px 8px rgba(10, 20, 40, 0.06)
        }

        .question {
            padding: 12px;
            border-radius: 8px;
            border: 1px solid #e6f3ff;
            margin-bottom: 10px;
            background: #fbfeff
        }

        .q-title {
            font-weight: 700;
            margin-bottom: 16px
        }

        label.option {
            display: block;
            padding: 8px;
            border-radius: 6px;
            margin-bottom: 6px;
            border: 1px solid #dbe4ff;
            cursor: pointer;
            background: transparent
        }

        input[type="radio"] {
            margin-right: 8px;
            float: left;
        }

        .controls {
            display: flex;
            gap: 8px;
            margin-top: 12px
        }

        button {
            background: #0b3d91;
            color: #fff;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer
        }

        button.secondary {
            background: #2b7a78
        }

        #result {
            background: #001f3f;
            color: #e6f6ff;
            padding: 12px;
            border-radius: 8px;
            margin-top: 12px;
            display: none
        }

        .correct {
            background: #e6ffef;
            border-color: #c6f6d5
        }

        .wrong {
            background: #fff0f0;
            border-color: #ffd6d6
        }

        .info {
            font-size: 13px;
            color: #445;
            margin-top: 8px
        }

        .toprow {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap
        }

        .name-input {
            padding: 8px;
            border-radius: 6px;
            border: 1px solid #dbeafe;
            font-size: 14px
        }

        .badge {
            background: #0b3d91;
            color: #fff;
            padding: 6px 10px;
            border-radius: 8px;
            font-weight: 700
        }

        footer {
            font-size: 13px;
            color: #445;
            margin-top: 14px
        }

        @media(max-width:600px) {
            .toprow {
                flex-direction: column;
                align-items: stretch
            }
        }

        /* images and code-option visuals */
        .opt-img {
            max-width: 100%;
            height: auto;
            border: 1px solid #e6eef9;
            border-radius: 6px;
            display: block;
            margin-top: 6px;
            margin-bottom: 16px;
        }

        .output {
            background: #001f3f;
            color: #e6f6ff;
            padding: 10px;
            border-radius: 6px;
            min-height: 40px;
            white-space: pre-wrap
        }

        /* Вариант A — современный (без изменения HTML) — подсветка label, когда внутри него checked */
        label.option:has(input:checked) {
            background: #e9fff3;
            border-color: #66d59a;
            box-shadow: 0 3px 10px rgba(34, 139, 34, 0.08);
            transform: translateY(-1px);
        }

        /* Вариант B — fallback для старых браузеров.
       Потребует изменить HTML: вынести <input> перед <label> и связать через id/for.
       Пример CSS (работает после изменения HTML): */
        input[type="radio"].quiz-radio:checked+label.option {
            background: #e9fff3;
            border-color: #66d59a;
            box-shadow: 0 3px 10px rgba(34, 139, 34, 0.08);
            transform: translateY(-1px);
        }

        /* плавность */
        label.option {
            transition: all 0.12s ease;
        }
    </style>
</head>

<body>
    <div class="wrap">
        <header>
            <div>
                <h1>Итоговый тест: Программирование на Python — Junior</h1>
                <div class="small">15 вопросов — выберите один правильный ответ на вопрос. Результат сохраняется
                    локально.</div>
            </div>
            <div style="margin-left:auto"><span class="badge">Автосохранение</span></div>
        </header>

        <div class="card">
            <div class="toprow">
                <div>
                    <label for="studentName"><strong>Имя ученика</strong></label><br>
                    <input id="studentName" class="name-input" placeholder="Введите ваше имя" />
                </div>
                <div style="margin-left:auto">
                    <button id="resetAll" class="secondary">Очистить прогресс</button>
                </div>
            </div>
        </div>

        <form id="quizForm">
            <!-- Questions -->
            <!-- Q1 -->
            <div class="card question" data-q="1">
                <div class="q-title">1. Программирование это?</div>
                <label class="option"><input type="radio" name="q1" value="1"> Процесс установки операционной системы и
                    настройки компьютера для работы с интернетом.</label>
                <label class="option"><input type="radio" name="q1" value="2"> Процесс составления алгоритмов и записи
                    их с помощью специального языка, понятного машине.</label>
                <label class="option"><input type="radio" name="q1" value="3"> Процесс настройки сетевого оборудования и
                    управления маршрутизаторами для обеспечения доступа в интернет.</label>
                <label class="option"><input type="radio" name="q1" value="4"> Процесс написания функций на
                    Python.</label>
            </div>

            <!-- Q2 -->
            <div class="card question" data-q="2">
                <div class="q-title">2. Найди ошибку в коде.</div>
                <img class="opt-img" src="https://quiz.top-academy.ru/uploads/quiz/2_1733244665.png"
                    alt="Кусок кода (q2)">
                <label class="option"><input type="radio" name="q2" value="1"> Неправильно объявлен список
                    студентов.</label>
                <label class="option"><input type="radio" name="q2" value="2"> Неправильно определен индекс последнего
                    студента.</label>
                <label class="option"><input type="radio" name="q2" value="3"> Нельзя создать список только из
                    строк.</label>
                <label class="option"><input type="radio" name="q2" value="4"> Нельзя использовать одинарные кавычки в
                    print().</label>
            </div>

            <!-- Q3 -->
            <div class="card question" data-q="3">
                <div class="q-title">3. Зачем нужны переменные?</div>
                <label class="option"><input type="radio" name="q3" value="1"> Для создания таблиц.</label>
                <label class="option"><input type="radio" name="q3" value="2"> Для хранения библиотек в Python.</label>
                <label class="option"><input type="radio" name="q3" value="3"> Для создания чисел в Python.</label>
                <label class="option"><input type="radio" name="q3" value="4"> Для хранения данных в коде.</label>
            </div>

            <!-- Q4 (image options) -->
            <div class="card question" data-q="4">
                <div class="q-title">4. Найди код без ошибок.</div>
                <label class="option"><input type="radio" name="q4" value="1"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/4_1_1733245270.png" alt="Вариант 1 (q4)"></label>
                <label class="option"><input type="radio" name="q4" value="2"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/4_2_1733245271.png" alt="Вариант 2 (q4)"></label>
                <label class="option"><input type="radio" name="q4" value="3"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/4_3_1733245271.png" alt="Вариант 3 (q4)"></label>
                <label class="option"><input type="radio" name="q4" value="4"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/4_4_1733245271.png" alt="Вариант 4 (q4)"></label>
                <label class="option"><input type="radio" name="q4" value="5"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/4_5_1733245271.png" alt="Вариант 5 (q5)"></label>
            </div>

            <!-- Q5 -->
            <div class="card question" data-q="5">
                <div class="q-title">5. Какой тип данных будет иметь результат вычислений?</div>
                <img class="opt-img" src="https://quiz.top-academy.ru/uploads/quiz/5_1733245305.png"
                    alt="Кусок кода (q5)">
                <label class="option"><input type="radio" name="q5" value="1"> bool</label>
                <label class="option"><input type="radio" name="q5" value="2"> float</label>
                <label class="option"><input type="radio" name="q5" value="3"> double</label>
                <label class="option"><input type="radio" name="q5" value="4"> int</label>
            </div>

            <!-- Q6 -->
            <div class="card question" data-q="6">
                <div class="q-title">6. Что такое input()?</div>
                <label class="option"><input type="radio" name="q6" value="1"> Одно из трех непростительных
                    заклятий.</label>
                <label class="option"><input type="radio" name="q6" value="2"> Функция для вывода данных.</label>
                <label class="option"><input type="radio" name="q6" value="3"> Функция для ввода данных.</label>
                <label class="option"><input type="radio" name="q6" value="4"> Функция для удаления данных.</label>
            </div>

            <!-- Q7 -->
            <div class="card question" data-q="7">
                <div class="q-title">7. Какие условные операторы есть в Python?</div>
                <label class="option"><input type="radio" name="q7" value="1"> else, do, if</label>
                <label class="option"><input type="radio" name="q7" value="2"> if, neif, else</label>
                <label class="option"><input type="radio" name="q7" value="3"> elif, else, if</label>
                <label class="option"><input type="radio" name="q7" value="4"> else, if, else if</label>
            </div>

            <!-- Q8 (image options) -->
            <div class="card question" data-q="8">
                <div class="q-title">8. Найди код без ошибок.</div>
                <label class="option"><input type="radio" name="q8" value="1"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/8_1_1733245387.png" alt="Вариант 1 (q8)"></label>
                <label class="option"><input type="radio" name="q8" value="2"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/8_2_1733245387.png" alt="Вариант 2 (q8)"></label>
                <label class="option"><input type="radio" name="q8" value="3"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/8_3_1733245387.png" alt="Вариант 3 (q8)"></label>
                <label class="option"><input type="radio" name="q8" value="4"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/8_4_1733245387.png" alt="Вариант 4 (q8)"></label>
            </div>

            <!-- Q9 -->
            <div class="card question" data-q="9">
                <div class="q-title">9. Найди ошибку в коде программы, которая считает сумму всех нечетных чисел в
                    заданном диапазоне.</div>
                <img class="opt-img" src="https://quiz.top-academy.ru/uploads/quiz/9_1733245455.png"
                    alt="Кусок кода (q9)">
                <label class="option"><input type="radio" name="q9" value="1"> Ошибку вызывает \t.</label>
                <label class="option"><input type="radio" name="q9" value="2"> Переменная number не увеличивается,
                    поэтому цикл бесконечный.</label>
                <label class="option"><input type="radio" name="q9" value="3"> Переменная finish должна быть
                    строкой.</label>
                <label class="option"><input type="radio" name="q9" value="4"> Переменная finish не увеличивается,
                    поэтому цикл бесконечный.</label>
            </div>

            <!-- Q10 -->
            <div class="card question" data-q="10">
                <div class="q-title">10. Чем цикл for отличается от цикла while?</div>
                <label class="option"><input type="radio" name="q10" value="1"> Цикл while работает медленнее цикла
                    for.</label>
                <label class="option"><input type="radio" name="q10" value="2"> Цикл while работает, пока выполняется
                    условие, а for — определенное количество итераций.</label>
                <label class="option"><input type="radio" name="q10" value="3"> Цикл for работает, пока выполняется
                    условие, а while — определенное количество итераций.</label>
                <label class="option"><input type="radio" name="q10" value="4"> Ничем не отличаются.</label>
            </div>

            <!-- Q11 (image options as in your example URLs) -->
            <div class="card question" data-q="11">
                <div class="q-title">11. Найди код, который выполнится без ошибок.</div>
                <label class="option"><input type="radio" name="q11" value="1"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/11_1_1733245511.png"
                        alt="Вариант 1 (q11)"></label>
                <label class="option"><input type="radio" name="q11" value="2"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/11_2_1733245511.png"
                        alt="Вариант 2 (q11)"></label>
                <label class="option"><input type="radio" name="q11" value="3"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/11_3_1733245511.png"
                        alt="Вариант 3 (q11)"></label>
                <label class="option"><input type="radio" name="q11" value="4"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/11_4_1733245511.png"
                        alt="Вариант 4 (q11)"></label>
            </div>

            <!-- Q12 -->
            <div class="card question" data-q="12">
                <div class="q-title">12. Что делает метод lower() у строки?</div>
                <label class="option"><input type="radio" name="q12" value="1"> Преобразует текст в нижний
                    регистр.</label>
                <label class="option"><input type="radio" name="q12" value="2"> Уменьшает строку.</label>
                <label class="option"><input type="radio" name="q12" value="3"> Унижает строку.</label>
                <label class="option"><input type="radio" name="q12" value="4"> Опускает строку вниз.</label>
            </div>

            <!-- Q13 (image options) -->
            <div class="card question" data-q="13">
                <div class="q-title">13. Найдите код, который делает то же самое, что и изображено на картинке.</div>
                <img class="opt-img" src="https://quiz.top-academy.ru/uploads/quiz/13_1733245610.png"
                    alt="Иллюстрация задания (q13)">
                <label class="option"><input type="radio" name="q13" value="1"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/13_1_1733245610.png"
                        alt="Вариант 1 (q13)"></label>
                <label class="option"><input type="radio" name="q13" value="2"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/13_2_1733245610.png"
                        alt="Вариант 2 (q13)"></label>
                <label class="option"><input type="radio" name="q13" value="3"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/13_3_1733245610.png"
                        alt="Вариант 3 (q13)"></label>
                <label class="option"><input type="radio" name="q13" value="4"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/13_4_1733245610.png"
                        alt="Вариант 4 (q13)"></label>
            </div>

            <!-- Q14 (image options) -->
            <div class="card question" data-q="14">
                <div class="q-title">14. Найди код, который нарисует квадрат.</div>
                <label class="option"><input type="radio" name="q14" value="1"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/14_1_1733245652.png"
                        alt="Вариант 1 (q14)"></label>
                <label class="option"><input type="radio" name="q14" value="2"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/14_2_1733245652.png"
                        alt="Вариант 2 (q14)"></label>
                <label class="option"><input type="radio" name="q14" value="3"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/14_3_1733245652.png"
                        alt="Вариант 3 (q14)"></label>
                <label class="option"><input type="radio" name="q14" value="4"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/14_4_1733245652.png"
                        alt="Вариант 4 (q14)"></label>
            </div>

            <!-- Q15 (image options) -->
            <div class="card question" data-q="15">
                <div class="q-title">15. Найди код, который найдет четное число в списке и остановится.</div>
                <label class="option"><input type="radio" name="q15" value="1"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/15_1_1733245688.png"
                        alt="Вариант 1 (q15)"></label>
                <label class="option"><input type="radio" name="q15" value="2"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/15_2_1733245688.png"
                        alt="Вариант 2 (q15)"></label>
                <label class="option"><input type="radio" name="q15" value="3"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/15_3_1733245688.png"
                        alt="Вариант 3 (q15)"></label>
                <label class="option"><input type="radio" name="q15" value="4"> <img class="opt-img"
                        src="https://quiz.top-academy.ru/uploads/quiz/15_4_1733245688.png"
                        alt="Вариант 4 (q15)"></label>
            </div>

            <div class="controls">
                <button type="button" id="checkBtn">Проверить</button>
                <button type="button" id="retryBtn" class="secondary">Пройти заново</button>
                <button type="button" id="sendBtn" class="secondary">Отправить результат учителю</button>
            </div>

            <!-- попытки: показываем пользователю сколько осталось -->
            <div id="attemptsInfo" class="info" style="margin-top:10px;"></div>
        </form>

        <div id="result"></div>

        <footer class="small">Результат сохраняется в браузере — при перезагрузке вы сможете продолжить с того же места.
        </footer>
    </div>

    <script>
        /*
          Автономный тест.
          correctAnswers — индекс строки (строки значений "1","2"...)
          Если нужно изменить правильные ответы — редактируйте этот массив.
        */
        const correctAnswers = {
            q1: "2",
            q2: "2",
            q3: "4",
            q4: "2",
            q5: "2",
            q6: "3",
            q7: "3",
            q8: "2",
            q9: "2",
            q10: "2",
            q11: "4",
            q12: "1",
            q13: "3",
            q14: "1",
            q15: "1"
        };

        // page elements
        const nameInput = document.getElementById('studentName');
        const resultDiv = document.getElementById('result');
        const checkBtn = document.getElementById('checkBtn');
        const retryBtn = document.getElementById('retryBtn');
        const sendBtn = document.getElementById('sendBtn');
        const form = document.getElementById('quizForm');

        // keys for localStorage
        const LS_NAME = 'py_junior_name_v1';
        const LS_ANS = 'py_junior_answers_v1';
        const LS_ATTEMPTS = 'py_junior_attempts_v1';

        // Configure number of allowed attempts (set 3 or 5)
        const MAX_ATTEMPTS = 3;

        // restore saved name and answers
        function loadState() {
            const savedName = localStorage.getItem(LS_NAME);
            if (savedName) nameInput.value = savedName;
            const saved = localStorage.getItem(LS_ANS);
            if (saved) {
                try {
                    const answers = JSON.parse(saved);
                    for (const q in answers) {
                        const v = answers[q];
                        const el = form.querySelector(`[name="${q}"][value="${v}"]`);
                        if (el) el.checked = true;
                    }
                } catch (e) { console.warn('Restore failed', e); }
            }
        }
        function saveState() {
            localStorage.setItem(LS_NAME, nameInput.value || '');
            // collect answers
            const answers = {};
            for (let i = 1; i <= 15; i++) {
                const name = 'q' + i;
                const checked = form.querySelector(`[name="${name}"]:checked`);
                if (checked) answers[name] = checked.value;
            }
            localStorage.setItem(LS_ANS, JSON.stringify(answers));
        }

        // attempts UI
        function getAttempts() {
            return parseInt(localStorage.getItem(LS_ATTEMPTS) || '0', 10);
        }
        function setAttempts(n) {
            localStorage.setItem(LS_ATTEMPTS, String(n));
        }
        function updateAttemptsInfo() {
            const used = getAttempts();
            const left = Math.max(0, MAX_ATTEMPTS - used);
            const el = document.getElementById('attemptsInfo');
            if (!el) return;
            if (used === 0) el.textContent = `Попыток: 0 из ${MAX_ATTEMPTS}. Удачи!`;
            else if (used < MAX_ATTEMPTS) el.textContent = `Попытка ${used} из ${MAX_ATTEMPTS}. Осталось попыток: ${left}. Правильные ответы будут показаны после ${MAX_ATTEMPTS}-й попытки.`;
            else el.textContent = `Использовано ${used} из ${MAX_ATTEMPTS} попыток. Правильные ответы показаны.`;
            // disable check button after final attempt (optional)
            checkBtn.disabled = (used >= MAX_ATTEMPTS);
        }

        // update state on changes
        form.addEventListener('change', saveState);
        nameInput.addEventListener('input', saveState);

        // helper to clear highlights
        function clearHighlights() {
            const blocks = document.querySelectorAll('.question');
            blocks.forEach(b => {
                b.classList.remove('correct', 'wrong');
                const labels = b.querySelectorAll('label.option');
                labels.forEach(l => l.style.opacity = '1');
            });
            resultDiv.style.display = 'none';
            resultDiv.innerHTML = '';
        }

        // check answers
        function checkAnswers() {
            // require name
            const student = nameInput.value.trim();
            if (!student) {
                alert('Пожалуйста, введите имя ученика вверху перед проверкой.');
                nameInput.focus();
                return;
            }

            // increment attempts
            let attempts = getAttempts();
            attempts = attempts + 1;
            setAttempts(attempts);
            updateAttemptsInfo();

            clearHighlights();

            let score = 0;
            let total = 15;
            const wrongList = [];

            const revealCorrect = (attempts >= MAX_ATTEMPTS);

            for (let i = 1; i <= 15; i++) {
                const qname = 'q' + i;
                const chosen = form.querySelector(`[name="${qname}"]:checked`);
                const block = document.querySelector(`.question[data-q="${i}"]`);
                const correctVal = correctAnswers[qname];

                if (chosen && chosen.value === correctVal) {
                    score += 1;
                    // show positive feedback even before final attempt
                    block.classList.add('correct');
                } else {
                    block.classList.add('wrong');
                    wrongList.push(i);
                }

                // If reveal allowed, highlight correct label and dim others (full reveal)
                if (revealCorrect) {
                    const correctInput = block.querySelector(`[name="${qname}"][value="${correctVal}"]`);
                    if (correctInput) {
                        const correctLabel = correctInput.closest('label.option');
                        if (correctLabel) correctLabel.style.borderColor = '#66d59a';
                    }
                    const labels = block.querySelectorAll('label.option');
                    labels.forEach(l => {
                        const inp = l.querySelector('input');
                        if (inp && inp.value !== correctVal) l.style.opacity = '0.9';
                    });
                } else {
                    // Before final attempt: DO NOT reveal which option is correct.
                    // Instead, slightly dim only those the user didn't pick to keep focus.
                    const labels = block.querySelectorAll('label.option');
                    labels.forEach(l => {
                        const inp = l.querySelector('input');
                        if (inp && (!chosen || inp.value !== chosen.value)) l.style.opacity = '0.95';
                    });
                }
            }

            const percent = Math.round((score / total) * 100);
            let message = '';
            if (score >= 13) message = 'Отлично!';
            else if (score >= 10) message = 'Хорошо!';
            else if (score >= 7) message = 'Неплохо, но можно лучше!';
            else message = 'Попробуй ещё раз!';

            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `<strong>Ученик:</strong> ${escapeHtml(student)}<br>
                         <strong>Баллы:</strong> ${score}/${total} (${percent}%) — <em>${message}</em>
                         <div style="margin-top:6px;font-size:13px;color:#445">${revealCorrect ? 'Правильные ответы показаны.' : 'Правильные ответы будут показаны после последней попытки.'}</div>`;

            // save last result
            localStorage.setItem(LS_NAME, student);
            localStorage.setItem('py_junior_last_result_v1', JSON.stringify({ student, score, total, percent, when: Date.now(), attempts }));
            saveState();
        }

        // retry: clear answers (does not reset attempts)
        function retry() {
            if (!confirm('Очистить ответы и начать заново?')) return;
            const inputs = form.querySelectorAll('input[type="radio"]');
            inputs.forEach(i => i.checked = false);
            clearHighlights();
            saveState();
        }

        // send result: copy to clipboard
        function sendResult() {
            const student = nameInput.value.trim();
            if (!student) { alert('Введите имя ученика'); nameInput.focus(); return; }
            const last = localStorage.getItem('py_junior_last_result_v1');
            if (!last) { alert('Сначала нажмите Проверить, чтобы получить результат.'); return; }
            const data = JSON.parse(last);
            const text = `Результат теста: ${data.student} — ${data.score}/${data.total} (${data.percent}%)`;
            navigator.clipboard.writeText(text).then(() => {
                alert('Результат скопирован в буфер. Отправьте его учителю (в чат или почту).');
            }).catch(() => { alert('Не удалось скопировать автоматически. Выделите и нажмите Ctrl+C.'); });
        }

        // small helper
        function escapeHtml(str) { return String(str).replace(/[&<>"']/g, function (m) { return { '&': '&amp;', '<': '&lt;', '>': '&gt;', '"': '&quot;', "'": '&#39;' }[m]; }); }

        // attach handlers
        checkBtn.addEventListener('click', checkAnswers);
        retryBtn.addEventListener('click', retry);
        sendBtn.addEventListener('click', sendResult);
        document.getElementById('resetAll').addEventListener('click', () => {
            if (!confirm('Удалить сохранённый прогресс и имя?')) return;
            localStorage.removeItem(LS_NAME);
            localStorage.removeItem(LS_ANS);
            localStorage.removeItem('py_junior_last_result_v1');
            localStorage.removeItem(LS_ATTEMPTS);
            location.reload();
        });

        // restore on load
        loadFromStorageOnStart();
        updateAttemptsInfo();
        function loadFromStorageOnStart() {
            try {
                const savedName = localStorage.getItem(LS_NAME);
                if (savedName) nameInput.value = savedName;
                const saved = localStorage.getItem(LS_ANS);
                if (saved) {
                    const answers = JSON.parse(saved);
                    for (const q in answers) {
                        const v = answers[q];
                        const el = form.querySelector(`[name="${q}"][value="${v}"]`);
                        if (el) el.checked = true;
                    }
                }
                // restore attempts count
                const att = parseInt(localStorage.getItem(LS_ATTEMPTS) || '0', 10);
                if (!isNaN(att) && att > 0) setAttempts(att);
                updateAttemptsInfo();
            } catch (e) { console.warn(e); }
        }
    </script>
</body>

</html>